import React, { useState } from "react"
import { Link } from "gatsby"
import { Box, Flex, color, Icon, radius, shadow } from "./Style"
import { Heading, globalPhoneGap, RowMaxWidth } from "./Layout"

import ModalCalculator from "./ModalCalculator"
import ModalContact from "./ModalContact"

export default ({ white }) => {
  const [contactModalOpen, setContactModalOpen] = useState(false)
  const [calculatorModalOpen, setCalculatorModalOpen] = useState(false)

  return (
    <>
      <RowMaxWidth>
        <Flex jcsb aic gap={1.5} py={1.5}>
          <Heading>
            <Link to={"/"}>
              <Icon source={logo} fill={white ? color.white : color.ezessay} />
            </Link>
          </Heading>

          <Flex>
            <Flex gap={1.5} aic>
              <Link
                to={"/blog/"}
                style={{ color: white ? color.white : color.black }}
              >
                写作指导
              </Link>
              <a
                href="https://ezessay.com/user/login/index.html"
                target="_blank"
                rel="noopener noreferrer"
                style={{ color: white ? color.white : color.black }}
              >
                用户登录
              </a>
            </Flex>

            <Flex
              z={100}
              ml={[null, 1.5]}
              gap={1.5}
              aic
              position={["fixed", null]}
              bg={[color.black, null]}
              bottom={[globalPhoneGap, null]}
              left={[globalPhoneGap, null]}
              right={[0, null]}
            >
              <Flex
                aic
                weight={"bold"}
                bg={color.white}
                color={color.black}
                r={radius.pill}
                p={1}
                cursor={"pointer"}
                s={shadow.lg}
                onClick={() => setCalculatorModalOpen(true)}
              >
                <Icon source={calc} mr={0.5} />
                <Box as="span" display={["none", null]}>
                  预
                </Box>
                估价
                <Box as="span" display={["none", null]}>
                  格
                </Box>
              </Flex>
              <Flex
                aic
                weight={"bold"}
                bg={color.white}
                color={color.black}
                r={radius.pill}
                p={1}
                cursor={"pointer"}
                s={shadow.lg}
                onClick={() => setContactModalOpen(true)}
              >
                <Icon source={talk} mr={0.5} />
                联系
                <Box as="span" display={["none", null]}>
                  方式
                </Box>
              </Flex>
            </Flex>
          </Flex>
        </Flex>
      </RowMaxWidth>

      {/* Contact Modal */}
      <ModalContact
        state={contactModalOpen}
        close={() => setContactModalOpen(false)}
      />

      {/* Calculator Modal */}
      <ModalCalculator
        state={calculatorModalOpen}
        close={() => setCalculatorModalOpen(false)}
      />
    </>
  )
}

// svg

export const logo = () => (
  <svg
    width="109"
    height="30"
    viewBox="0 0 109 30"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M41.8341 20.2759C41.8341 21.1234 41.1212 21.7893 40.2818 21.7893H31.7147C30.8468 21.7893 30.165 21.1234 30.165 20.2759V2.18369C30.165 1.33873 30.8468 0.672852 31.7147 0.672852H40.2818C41.1212 0.672852 41.8341 1.33873 41.8341 2.18369C41.8341 3.03117 41.1212 3.69958 40.2818 3.69958H33.2643V9.77825H40.3283C41.1626 9.77825 41.878 10.4441 41.878 11.2891C41.878 12.1366 41.1626 12.8024 40.3283 12.8024H33.2643V18.7626H40.2818C41.1212 18.7626 41.8341 19.4285 41.8341 20.2759ZM10.2312 21.8113C11.0706 21.8113 11.7835 21.1454 11.7835 20.2979C11.7835 19.4504 11.0706 18.7846 10.2312 18.7846H3.14659V12.8244H10.2132C11.0474 12.8244 11.7603 12.1586 11.7603 11.3111C11.7603 10.4661 11.0474 9.80022 10.2132 9.80022H3.14659V3.72155H10.2312C11.0706 3.72155 11.7835 3.05315 11.7835 2.20567C11.7835 1.36071 11.0706 0.694824 10.2312 0.694824H1.59949C0.731666 0.694824 0.0498047 1.36071 0.0498047 2.20567V20.2979C0.0498047 21.1454 0.731666 21.8113 1.59949 21.8113H10.2312ZM25.822 21.7354C26.6562 21.7354 27.3407 21.0393 27.3407 20.2221C27.3407 19.4048 26.6562 18.739 25.822 18.739H19.2539L26.9972 8.96769C27.3717 8.51368 27.4311 7.90834 27.1547 7.39631C26.9068 6.8515 26.3463 6.54883 25.76 6.54883H16.1261C15.2893 6.54883 14.6074 7.21471 14.6074 8.03193C14.6074 8.84662 15.2893 9.54529 16.1261 9.54529H22.6916L14.9484 19.2838C14.579 19.7378 14.5145 20.3431 14.796 20.8879C15.0414 21.4025 15.5992 21.7354 16.1881 21.7354H25.822ZM50.2323 21.7125C54.7548 21.7125 55.4057 18.0527 55.4057 17.1749C55.4057 15.9365 54.6954 14.6325 53.5796 13.7572C52.3932 12.8638 51.0426 12.685 49.9315 12.538C48.6335 12.3661 47.6624 12.2376 47.6624 11.0634C47.6624 10.0369 48.6542 9.40125 49.7984 9.40125C50.6662 9.40125 51.968 9.67113 52.4019 10.5186L52.4268 10.5553C52.7855 11.0851 53.1004 11.5502 53.8276 11.5502C54.6644 11.5502 55.3463 10.8516 55.4057 10.0949C55.4057 8.32746 53.3291 7.33647 52.884 7.1241L52.8358 7.10094C51.9086 6.64693 50.8832 6.40479 49.863 6.40479C47.1355 6.40479 44.625 8.13002 44.625 11.0332C44.625 14.3626 47.8794 15.3589 49.7674 15.5707C51.2577 15.7246 52.3399 16.1483 52.3399 17.1749L52.3392 17.1805C52.3065 17.4368 52.1391 18.7488 50.1729 18.7488C48.8402 18.6883 48.0963 18.2923 47.3835 17.3288C47.1045 16.963 46.6396 16.7512 46.2057 16.7512C45.3405 16.7512 44.625 17.4776 44.625 18.2343C44.625 18.3831 44.625 18.5369 44.6896 18.658C45.5264 20.7767 48.0654 21.7125 50.2323 21.7125ZM69.0112 17.1749C69.0112 18.0527 68.3603 21.7125 63.8378 21.7125C61.6708 21.7125 59.1319 20.7767 58.2951 18.658C58.2305 18.5369 58.2305 18.3831 58.2305 18.2343C58.2305 17.4776 58.946 16.7512 59.8112 16.7512C60.2451 16.7512 60.71 16.963 60.989 17.3288C61.7018 18.2923 62.4457 18.6883 63.7784 18.7488C65.7446 18.7488 65.912 17.4368 65.9447 17.1805L65.9454 17.1749C65.9454 16.1483 64.8632 15.7246 63.3729 15.5707C61.4849 15.3589 58.2305 14.3626 58.2305 11.0332C58.2305 8.13002 60.741 6.40479 63.4685 6.40479C64.4887 6.40479 65.5141 6.64693 66.4413 7.10094L66.4895 7.1241C66.9345 7.33647 69.0112 8.32746 69.0112 10.0949C68.9518 10.8516 68.2699 11.5502 67.4331 11.5502C66.7059 11.5502 66.391 11.0851 66.0322 10.5553L66.0074 10.5186C65.5735 9.67113 64.2717 9.40125 63.4039 9.40125C62.2597 9.40125 61.2679 10.0369 61.2679 11.0634C61.2679 12.2376 62.2389 12.3661 63.537 12.538C64.6481 12.685 65.9987 12.8638 67.1851 13.7572C68.3009 14.6325 69.0112 15.9365 69.0112 17.1749ZM79.1161 9.52283C81.717 9.52283 83.7006 11.6693 83.7006 14.2117C83.7006 16.7517 81.717 18.6862 79.1161 18.6862C76.5152 18.6862 74.3147 16.7517 74.3147 14.2117C74.3147 11.6693 76.5152 9.52283 79.1161 9.52283ZM86.7354 20.1416V14.2117C86.7354 9.94657 83.4836 6.55664 79.1161 6.55664C74.7486 6.55664 71.2773 9.94657 71.2773 14.2117C71.2773 18.4744 74.7486 21.6524 79.1161 21.6524C80.8802 21.6524 82.3679 21.2287 83.7006 20.1416C83.7006 21.0168 84.5684 21.6524 85.1857 21.6524C86.0845 21.6524 86.7354 21.0168 86.7354 20.1416ZM108.971 18.6251C108.971 19.7475 108.058 20.6585 106.929 20.6585C105.802 20.6585 104.887 19.7475 104.887 18.6251C104.887 17.5028 105.802 16.5918 106.929 16.5918C108.058 16.5918 108.971 17.5028 108.971 18.6251ZM101.71 23.0124V8.10077C101.71 7.28356 101.026 6.61768 100.16 6.61768C99.3233 6.61768 98.644 7.28356 98.644 8.10077V15.602C98.644 17.3272 97.2183 18.717 95.4517 18.717C93.716 18.717 92.2619 17.3272 92.2619 15.602V8.10077C92.2619 7.28356 91.5801 6.61768 90.7432 6.61768C89.909 6.61768 89.2246 7.28356 89.2246 8.10077V15.6625C89.2581 18.9894 92.045 21.6832 95.4517 21.6832C96.6295 21.6832 97.7117 21.3805 98.644 20.8357V23.0124C98.644 24.7982 97.1538 26.2485 95.2967 26.2485C94.026 26.2485 92.8792 25.5549 92.2929 24.4375C91.952 23.7086 91.0222 23.3782 90.2783 23.7389C89.5035 24.1021 89.1936 25.0101 89.5655 25.7365C90.6503 27.8855 92.8482 29.245 95.2967 29.245C98.8274 29.245 101.71 26.4326 101.71 23.0124Z"
    />
  </svg>
)

const calc = () => (
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M5.57031 17.2578C5.90625 17.2578 6.09375 17.125 6.34375 16.7656L10.8281 10.0859L15.125 3.72656C15.25 3.53906 15.3125 3.375 15.3125 3.17188C15.3125 2.76562 14.9688 2.46875 14.5547 2.46875C14.1875 2.46875 13.9922 2.59375 13.7344 2.97656L9.38281 9.47656L4.96875 15.9844C4.84375 16.1641 4.77344 16.3203 4.77344 16.5547C4.77344 16.9844 5.14844 17.2578 5.57031 17.2578ZM4.64844 7.07812V8.60156C4.64844 9.07812 4.92969 9.35938 5.36719 9.35938C5.80469 9.35938 6.08594 9.07812 6.08594 8.60156V7.07812H7.51562C7.99219 7.07812 8.24219 6.79688 8.24219 6.39062C8.24219 5.96875 7.99219 5.6875 7.51562 5.6875H6.08594V4.16406C6.08594 3.6875 5.80469 3.41406 5.36719 3.41406C4.92969 3.41406 4.64844 3.6875 4.64844 4.16406V5.6875H3.22656C2.75781 5.6875 2.49219 5.96875 2.49219 6.39062C2.49219 6.79688 2.75781 7.07812 3.22656 7.07812H4.64844ZM11.9688 13.8125C11.9688 14.2422 12.2422 14.5156 12.7188 14.5156H16.7734C17.25 14.5156 17.5234 14.2422 17.5234 13.8125C17.5234 13.3906 17.25 13.1094 16.7734 13.1094H12.7188C12.2422 13.1094 11.9688 13.3906 11.9688 13.8125Z"
      fill="#58A193"
    />
  </svg>
)

const talk = () => (
  <svg
    width="20"
    height="20"
    viewBox="0 0 20 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M4.58594 18.5391C5.6875 18.5391 7.91406 17.5 9.61719 16.2812C15.1875 16.3438 19.3438 13.1094 19.3438 8.85938C19.3438 4.73438 15.2422 1.41406 10.1172 1.41406C5 1.41406 0.898438 4.73438 0.898438 8.85938C0.898438 11.4219 2.46094 13.7344 4.88281 14.9688C4.5625 15.5547 4.02344 16.3906 3.6875 16.8281C3.125 17.5781 3.54688 18.5391 4.58594 18.5391ZM5.61719 16.6875C5.49219 16.7344 5.44531 16.6719 5.53125 16.5625C5.89062 16.1094 6.46094 15.3672 6.77344 14.7969C7.01562 14.3438 6.90625 13.9531 6.40625 13.7188C4.08594 12.6172 2.72656 10.8594 2.72656 8.85938C2.72656 5.75781 6.00781 3.23438 10.1172 3.23438C14.2344 3.23438 17.5156 5.75781 17.5156 8.85938C17.5156 11.9531 14.2344 14.4766 10.1172 14.4766C9.98438 14.4766 9.78906 14.4688 9.54688 14.4688C9.21094 14.4609 8.96094 14.5547 8.64062 14.8125C7.71094 15.5078 6.29688 16.4141 5.61719 16.6875Z"
      fill="#D46077"
    />
  </svg>
)
